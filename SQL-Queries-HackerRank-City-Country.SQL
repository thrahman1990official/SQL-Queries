/* REFER TO CITY_TABLE_VERSION-2.png & COUNTRY_TABLE_VERSION-1.png */

/* CHALLENGE: ASIAN POPULATION */
/* GIVEN CITY & COUNTRY TABLES, QUERY SUM OF POPULATIONS OF ALL CITIES WHERE CONTINENT IS 'Asia' */
/* HINT: CITY.COUNTRYCODE & COUNTRY.CODE ARE MATCHING KEY COLUMNS */

SELECT SUM(CITY.POPULATION) FROM COUNTRY LEFT JOIN CITY ON COUNTRY.CODE = CITY.COUNTRYCODE WHERE COUNTRY.CONTINENT = 'Asia';

/* CHALLENGE: AFRICAN CITIES */
/* GIVEN CITY & COUNTRY TABLES, QUERY NAMES OF ALL CITIES WHERE CONTINENT IS 'Africa' */
/* HINT: CITY.COUNTRYCODE & COUNTRY.CODE ARE MATCHING KEY COLUMNS */

SELECT CITY.NAME FROM CITY JOIN COUNTRY ON CITY.COUNTRYCODE = COUNTRY.CODE WHERE COUNTRY.CONTINENT = 'Africa';

/* AVERAGE POPULATION OF EACH CONTINENT */
/* GIVEN CITY & COUNTRY TABLES, QUERY NAMES OF ALL CONTINENTS (COUNTRY.CONTINENT) & THEIR RESPECTIVE AVERAGE CITY POPULATIONS (CITY.POPULATION)
ROUNDED DOWN TO NEAREST INTEGER */
/* HINT: CITY.COUNTRYCODE & COUNTRY.CODE ARE MATCHING KEY COLUMNS */

SELECT COUNTRY.CONTINENT, FLOOR(AVG(CITY.POPULATION)) FROM COUNTRY JOIN CITY ON CITY.COUNTRYCODE = COUNTRY.CODE GROUP BY COUNTRY.CONTINENT;
